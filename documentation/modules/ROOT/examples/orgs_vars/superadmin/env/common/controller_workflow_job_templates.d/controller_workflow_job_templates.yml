---
controller_workflows:
  - name: "{{ orgs }} WF New Project"
    state: present
    description: "Workflow to create a new project"
    ask_variables_on_launch: false
    allow_simultaneous: true
    scm_branch: "{{ env }}"
    organization: "{{ orgs }}"
    simplified_workflow_nodes:
      - identifier: "Create Webhooks"
        workflow_job_template: "{{ orgs }} WF New Project"
        unified_job_template: "{{ orgs }} Gitlab Webhook Creation"
        job_type: run
        organization: "{{ orgs }}"
        workflow: "{{ orgs }} WF New Project"

      - identifier: "Create SuperAdmin Objects"
        workflow_job_template: "{{ orgs }} WF New Project"
        unified_job_template: "{{ orgs }} New Organization Objects"
        job_type: run
        organization: "{{ orgs }}"
        workflow: "{{ orgs }} WF New Project"
        success_nodes:
          - "Create Webhooks"

      - identifier: "Create GitLab Repo"
        workflow_job_template: "{{ orgs }} WF New Project"
        unified_job_template: "{{ orgs }} Gitlab Project Creation"
        job_type: run
        organization: "{{ orgs }}"
        workflow: "{{ orgs }} WF New Project"
        extra_data:
          automation_hub: "ah22.iam.lab"
          controller_dev: "aap22dev.iam.lab"
          controller_pro: "aap22pro.iam.lab"
          gitlab_api_url: "https://gitlab.iam.lab"
          gitlab_group: "automationiberia"
          gitlab_subgroup: "aap-cac"
          gitlab_project: "dummy"
          gitlab_visibility: "internal"
          gitlab_default_branch: "pro"
          gitlab_http_protocol: "https"
          gitlab_branches_string: "dummy"
        success_nodes:
          - "Create SuperAdmin Objects"
    notification_templates_started: []
    notification_templates_success: []
    notification_templates_error: []
    notification_templates_approvals: []
    extra_vars:
      orgs: "{{ orgs }}"
      orgs_vars: "{{ orgs_vars | default(dir_orgs_vars) }}"
      env: "{{ env }}"
    survey_enabled: True
    survey_spec:
      name: '{{ orgs }} Survey_Gitlab_Project_Creation'
      description: 'Survey_Gitlab_Project_Creation'
      spec:
        - question_name: Name for the new Organization
          question_description: Must be the same name of GitLab project to be created
          required: true
          type: text
          variable: "organization_name"
          min: 0
          max: 80
          new_question: true

        - question_name: Organization description
          required: true
          type: text
          variable: "organization_desc"
          min: 0
          max: 80
          new_question: true

        - question_name: Instance groups to assign the new organization to
          required: true
          type: text
          variable: "instance_groups"
          min: 0
          max: 80
          new_question: true

        - question_name: Admin user for the new Organization
          required: true
          type: text
          variable: "admin_user"
          min: 0
          max: 80
          new_question: true

        - question_name: Private Automation Hub Host
          required: true
          type: multiplechoice
          variable: automation_hub
          min: 0
          max: 1024
          choices:
            - "ah22.iam.lab"
            - "lb-hub-pro.lab.example.com"
          default: "ah22.iam.lab"
          new_question: true

        - question_name: Ansible Controller Host (Dev)
          required: true
          type: multiplechoice
          variable: controller_dev
          min: 0
          max: 1024
          choices:
            - "aap22dev.iam.lab"
          default: "aap22dev.iam.lab"
          new_question: true

        - question_name: Ansible Controller Host (Pro)
          required: true
          type: multiplechoice
          variable: controller_pro
          min: 0
          max: 1024
          choices:
            - "aap22prod.iam.lab"
          default: "aap22prod.iam.lab"
          new_question: true

        - question_name: GitLab API URL
          required: true
          type: multiplechoice
          variable: gitlab_api_url
          min: 0
          max: 1024
          choices:
            - "https://gitlab.iam.lab"
          default: "https://gitlab.iam.lab"
          new_question: true

        - question_name: GitLab group name
          required: true
          type: multiplechoice
          variable: gitlab_group
          min: 0
          max: 1024
          choices:
            - "automationiberia"
          default: "automationiberia"
          new_question: true

        - question_name: GitLab subgroup name
          required: true
          type: multiplechoice
          variable: gitlab_subgroup
          min: 0
          max: 1024
          choices:
            - "aap-cac"
          default: "aap-cac"
          new_question: true

        - question_name: GitLab Project
          question_description: Must be the same name of the organization to be created
          required: true
          type: text
          variable: "gitlab_project"
          min: 0
          max: 80
          new_question: true

        - question_name: GitLab project's visibility
          required: true
          type: multiplechoice
          variable: gitlab_visibility
          min: 0
          max: 1024
          choices:
            - "internal"
            - "public"
          default: "public"
          new_question: true

        - question_name: GitLab default branch
          required: true
          type: multiplechoice
          variable: gitlab_default_branch
          min: 0
          max: 1024
          choices:
            - "pro"
          default: "pro"
          new_question: true

        - question_name: GitLab http connection Protocol
          required: true
          type: multiplechoice
          variable: gitlab_http_protocol
          min: 0
          max: 1024
          choices:
            - "https"
            - "http"
          default: "https"
          new_question: true

        - question_name: GitLab branches to be created
          required: true
          type: textarea
          variable: gitlab_branches_string
          min: 0
          max: 1024
          default: "dev\npro"
          new_question: true
...
